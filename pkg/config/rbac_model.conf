# Request definition: defines the structure of authorization requests
# Format: subject (user ID), domain (org:id or canvas:id), object (resource type), action (operation)
[request_definition]
r = sub, dom, obj, act

# Policy definition: defines the structure of permission rules
# Format: subject (role name), domain (org:id or canvas:id), object (resource type), action (operation)
[policy_definition]
p = sub, dom, obj, act

# Role definition: defines inheritance relationships
# g = user-to-role/group mapping with domain (user_id, role_or_group, org:id_or_canvas:id)
[role_definition]
g = _, _, _

# Policy effect: allow if any matching policy allows the request
[policy_effect]
e = some(where (p.eft == allow))

# Matchers: defines the logic for matching requests to policies
# g(r.sub, p.sub, r.dom) - check if request subject has policy role in request domain
# r.dom == p.dom - ensure domain matches between request and policy
# r.act == p.act - ensure action matches between request and policy
[matchers]
m = g(r.sub, p.sub, r.dom) && r.dom == p.dom && r.act == p.act