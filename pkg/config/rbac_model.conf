# Casbin RBAC model configuration for Superplane
# This model supports both organization-level and resource-level (canvas) permissions

[request_definition]
r = sub, obj, act

[policy_definition]
p = sub, obj, act

[role_definition]
g = _, _

[policy_effect]
e = some(where (p.eft == allow))

[matchers]
# The matcher supports:
# 1. Direct role permissions: g(r.sub, p.sub) && r.obj == p.obj && r.act == p.act
# 2. Resource-specific roles: g(r.sub, p.sub + ":" + extractCanvasId(r.obj)) && r.act == p.act
# 3. Wildcard matching for resources: g(r.sub, p.sub) && keyMatch2(r.obj, p.obj) && r.act == p.act
m = g(r.sub, p.sub) && r.obj == p.obj && r.act == p.act || \
    g(r.sub, p.sub) && keyMatch2(r.obj, p.obj) && r.act == p.act