# Default values for superplane.
# This is a YAML-formatted file.
# Declare variables to be passed into your templates.

image:
  registry: ghcr.io/superplanehq
  name: superplane
  pullPolicy: IfNotPresent
  pullSecrets: []

workers:
  replicas: 1
  dbPoolSize: 5
  resources:
    limits:
      cpu: 100m
      memory: 128Mi
    requests:
      cpu: 100m
      memory: 128Mi

api:
  ownerSetupEnabled: true
  blockSignup: false
  replicas: 1
  dbPoolSize: 5
  resources:
    limits:
      cpu: 100m
      memory: 128Mi
    requests:
      cpu: 100m
      memory: 128Mi

domain:
  name: ""
  configMapName: "base-domain"

authentication:
  secretName: ""
  github:
    enabled: true
    clientId: ""
    clientSecret: ""
  google:
    enabled: true
    clientId: ""
    clientSecret: ""

#
# Key used to encrypt sensitive values before storing them in the database.
#
encryption:
  secretName: ""
  key: ""

telemetry:
  secretName: ""
  opentelemetry:
    enabled: true
    endpoint: ""
    protocol: ""
    headers: ""
    serviceName: ""

sentry:
  secretName: ""
  enabled: false
  dsn: ""
  environment: ""

#
# Secret used to sign JWT tokens
#
jwt:
  secretName: ""
  secret: ""

session:
  secretName: ""
  key: ""

#
# Ingress configuration
#
ingress:
  enabled: true

  #
  # Specify the name of the static IP address
  # Required when ingress.className=gce
  #
  staticIpName: ""

  #
  # Set the Ingress class:
  # - gce: when deploying chart on GKE
  # - traefik: when deploying on VM with k3s
  #
  className: "gce"

  #
  # SSL Configuration
  #
  ssl:
    enabled: true
    type: "google"

    #
    # Use a Google-managed certificate.
    # Requires the name of the Google managed certificate in GCP
    #
    google:
      certName: ""

    #
    # Use a ALB certificate.
    #
    alb:
      certName: ""

    #
    # Use cert-manager to manage SSL certificates.
    # Requires cert-manager to be installed separately before installing this chart.
    # Install cert-manager with: helm install cert-manager jetstack/cert-manager --namespace cert-manager --create-namespace --set installCRDs=true
    # Set ingress.ssl.type to "cert-manager" to use this option.
    #
    certManager:
      issuerRef:
        name: ""
        kind: "ClusterIssuer" # Can be "Issuer" or "ClusterIssuer"
      secretName: "superplane-tls-secret"
      # Optional: Additional annotations for the Certificate resource
      annotations: {}
      # Create ClusterIssuer automatically (only used when kind is "ClusterIssuer")
      createClusterIssuer: false
      acme:
        # Email address for Let's Encrypt registration
        email: ""
        # ACME server URL (defaults to Let's Encrypt production)
        server: "https://acme-v02.api.letsencrypt.org/directory"

    #
    # Provide a custom certificate managed by yourself.
    # Requires the fullchain certificate and the private key used to generate it,
    # which will be stored in a Kubernetes secret for usage.
    #
    custom:
      secretName: "superplane-tls-secret"
      crt: ""
      key: ""

#
# Postgres configuration
#
database:
  secretName: ""
  host: "postgres"
  port: 5432
  username: postgres
  password: postgres
  ssl: false
  local:
    enabled: true
    version: 14.15-alpine3.21
    maxConnections: "1000"
    sharedBuffers: 1024MB
    size: 4Gi

#
# RabbitMQ configuration
#
rabbitmq:
  secretName: ""
  host: "rabbitmq"
  port: 5672
  managementPort: 15672
  username: rabbitmq
  password: rabbitmq
  protocol: amqp
  local:
    enabled: true
    version: 3.13.7-management-alpine
    size: 2Gi

#
# Email configuration
#
email:
  secretName: ""
  resendApiKey: ""
  fromName: ""
  fromAddress: ""
